<!--suppress JSAnnotator -->
<template>
    <!-- Page, data-name contains page name which can be used in callbacks -->
    <div class="page " > <!-- page-with-subnavbar -->
        <!-- Top Navbar -->
        <div class="navbar">
            <div class="navbar-bg"></div>
            <div class="navbar-inner">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon icon-back"></i>
                    </a>
                </div>
                <div class="title sliding">{{PageTitle}}</div>

            </div>
        </div>


        <div  class="page-content" >
            <div id="{{MapId}}" class="map"></div>
        </div>

    </div>



</template>


<script>
    // script must return component object
    return {
        data: function () {
            let self = this;
            let ret = {
                PageTitle: LANGUAGE.COM_MSG068,
                MapId: 'Map-' + self.$app.utils.id()
            };
            if(self.$route.query.id){
                let account = localStorage.ACCOUNT;
                let notifications = self.$app.methods.getFromStorage('notifications')[account];
                if (notifications && notifications.length) {
                    let notification = notifications.find(c => c.CustomId === self.$route.query.id);

                    if (notification) {
                        //ret.NotificationData = self.$app.methods.formatStatusMessage(notification);
                        ret.PageTitle = notification.customTitle;
                    }
                }
            }


            return ret;
        },

        methods: {


        },

        on: {
            pageInit: function (e, page) {
                let self = this;

                self.Map = Helper.Methods.createMap({ target: self.MapId, latLng: [9.675228, -171.364896], zoom: 2 });
                self.MarkersGroup = L.markerClusterGroup({'maxClusterRadius':35,});

            },
            pageBeforeRemove: function () {
                let self = this;


            }

        }
    };
</script>
